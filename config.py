import numpy as np
from sympy.parsing.mathematica import parse_mathematica
from sympy import I, N
from sympy import Function
from sympy import symbols
from scipy.optimize import show_options
import sympy as sym
import scipy as sp
import math
import random
import time
import matplotlib.pyplot as plt
import multiprocessing
from multiprocessing import Process
from multiprocessing import Pool

str_nS = "1-(-((2 b^2 E^(-((2 Ne1)/n)) (-1+n)^2 ((2 E^(Ne1/n) (-1+(E^(-(Ne1/n)) (-1+n))/n) n^2)/(b^2 (-1+n))-(2 E^((2 Ne1)/n) (-1+(E^(-(Ne1/n)) (-1+n))/n)^2 n^3)/(b^2 (-1+n)^2)))/((-1+(E^(-(Ne1/n)) (-1+n))/n)^2 n^4))-(1/((-1+(E^(-(Ne1/n)) (-1+n))/n)^2 n^4))b^2 E^(-((2 Ne1)/n)) (-1+n)^2 ((2 E^(Ne1/n) (-1+(E^(-(Ne1/n)) (-1+n))/n) n^2)/(b^2 (-1+n))-(2 E^((2 Ne1)/n) (-1+(E^(-(Ne1/n)) (-1+n))/n)^2 n^3)/(b^2 (-1+n)^2)) (-1-(24 E^((2 Ne1)/n) (-1+(E^(-(Ne1/n)) (-1+n))/n)^2 n^4 (1/4 c1 (3-n-Sqrt[1-2 n] Sqrt[(1+10 n+n^2)/(1-2 n)]) ((24 E^((2 Ne1)/n) (-1+(E^(-(Ne1/n)) (-1+n))/n)^2 n^4)/(b^2 (-1+n)^2)+6 ((2 E^(Ne1/n) (-1+(E^(-(Ne1/n)) (-1+n))/n) n^2)/(b^2 (-1+n))-(2 E^((2 Ne1)/n) (-1+(E^(-(Ne1/n)) (-1+n))/n)^2 n^3)/(b^2 (-1+n)^2)))^(-3+1/4 (3-n-Sqrt[1-2 n] Sqrt[(1+10 n+n^2)/(1-2 n)])) (-2+1/4 (3-n-Sqrt[1-2 n] Sqrt[(1+10 n+n^2)/(1-2 n)])) (-1+1/4 (3-n-Sqrt[1-2 n] Sqrt[(1+10 n+n^2)/(1-2 n)]))+1/4 c2 (3-n+Sqrt[1-2 n] Sqrt[(1+10 n+n^2)/(1-2 n)]) ((24 E^((2 Ne1)/n) (-1+(E^(-(Ne1/n)) (-1+n))/n)^2 n^4)/(b^2 (-1+n)^2)+6 ((2 E^(Ne1/n) (-1+(E^(-(Ne1/n)) (-1+n))/n) n^2)/(b^2 (-1+n))-(2 E^((2 Ne1)/n) (-1+(E^(-(Ne1/n)) (-1+n))/n)^2 n^3)/(b^2 (-1+n)^2)))^(-3+1/4 (3-n+Sqrt[1-2 n] Sqrt[(1+10 n+n^2)/(1-2 n)])) (-2+1/4 (3-n+Sqrt[1-2 n] Sqrt[(1+10 n+n^2)/(1-2 n)])) (-1+1/4 (3-n+Sqrt[1-2 n] Sqrt[(1+10 n+n^2)/(1-2 n)]))))/(b^2 (-1+n)^2 (1/4 c1 (3-n-Sqrt[1-2 n] Sqrt[(1+10 n+n^2)/(1-2 n)]) ((24 E^((2 Ne1)/n) (-1+(E^(-(Ne1/n)) (-1+n))/n)^2 n^4)/(b^2 (-1+n)^2)+6 ((2 E^(Ne1/n) (-1+(E^(-(Ne1/n)) (-1+n))/n) n^2)/(b^2 (-1+n))-(2 E^((2 Ne1)/n) (-1+(E^(-(Ne1/n)) (-1+n))/n)^2 n^3)/(b^2 (-1+n)^2)))^(-2+1/4 (3-n-Sqrt[1-2 n] Sqrt[(1+10 n+n^2)/(1-2 n)])) (-1+1/4 (3-n-Sqrt[1-2 n] Sqrt[(1+10 n+n^2)/(1-2 n)]))+1/4 c2 (3-n+Sqrt[1-2 n] Sqrt[(1+10 n+n^2)/(1-2 n)]) ((24 E^((2 Ne1)/n) (-1+(E^(-(Ne1/n)) (-1+n))/n)^2 n^4)/(b^2 (-1+n)^2)+6 ((2 E^(Ne1/n) (-1+(E^(-(Ne1/n)) (-1+n))/n) n^2)/(b^2 (-1+n))-(2 E^((2 Ne1)/n) (-1+(E^(-(Ne1/n)) (-1+n))/n)^2 n^3)/(b^2 (-1+n)^2)))^(-2+1/4 (3-n+Sqrt[1-2 n] Sqrt[(1+10 n+n^2)/(1-2 n)])) (-1+1/4 (3-n+Sqrt[1-2 n] Sqrt[(1+10 n+n^2)/(1-2 n)])))))+(b^2 E^(-((2 Ne1)/n)) (-1+n)^2 ((2 E^(Ne1/n) (-1+(E^(-(Ne1/n)) (-1+n))/n) n^2)/(b^2 (-1+n))-(2 E^((2 Ne1)/n) (-1+(E^(-(Ne1/n)) (-1+n))/n)^2 n^3)/(b^2 (-1+n)^2)))/((-1+(E^(-(Ne1/n)) (-1+n))/n)^2 n^4 (-1-(1/(2 (-1+(E^(-(Ne1/n)) (-1+n))/n)^2 n^4))b^2 E^(-((2 Ne1)/n)) (-1+n)^2 ((2 E^(Ne1/n) (-1+(E^(-(Ne1/n)) (-1+n))/n) n^2)/(b^2 (-1+n))-(2 E^((2 Ne1)/n) (-1+(E^(-(Ne1/n)) (-1+n))/n)^2 n^3)/(b^2 (-1+n)^2)) (-1-(24 E^((2 Ne1)/n) (-1+(E^(-(Ne1/n)) (-1+n))/n)^2 n^4 (1/4 c1 (3-n-Sqrt[1-2 n] Sqrt[(1+10 n+n^2)/(1-2 n)]) ((24 E^((2 Ne1)/n) (-1+(E^(-(Ne1/n)) (-1+n))/n)^2 n^4)/(b^2 (-1+n)^2)+6 ((2 E^(Ne1/n) (-1+(E^(-(Ne1/n)) (-1+n))/n) n^2)/(b^2 (-1+n))-(2 E^((2 Ne1)/n) (-1+(E^(-(Ne1/n)) (-1+n))/n)^2 n^3)/(b^2 (-1+n)^2)))^(-3+1/4 (3-n-Sqrt[1-2 n] Sqrt[(1+10 n+n^2)/(1-2 n)])) (-2+1/4 (3-n-Sqrt[1-2 n] Sqrt[(1+10 n+n^2)/(1-2 n)])) (-1+1/4 (3-n-Sqrt[1-2 n] Sqrt[(1+10 n+n^2)/(1-2 n)]))+1/4 c2 (3-n+Sqrt[1-2 n] Sqrt[(1+10 n+n^2)/(1-2 n)]) ((24 E^((2 Ne1)/n) (-1+(E^(-(Ne1/n)) (-1+n))/n)^2 n^4)/(b^2 (-1+n)^2)+6 ((2 E^(Ne1/n) (-1+(E^(-(Ne1/n)) (-1+n))/n) n^2)/(b^2 (-1+n))-(2 E^((2 Ne1)/n) (-1+(E^(-(Ne1/n)) (-1+n))/n)^2 n^3)/(b^2 (-1+n)^2)))^(-3+1/4 (3-n+Sqrt[1-2 n] Sqrt[(1+10 n+n^2)/(1-2 n)])) (-2+1/4 (3-n+Sqrt[1-2 n] Sqrt[(1+10 n+n^2)/(1-2 n)])) (-1+1/4 (3-n+Sqrt[1-2 n] Sqrt[(1+10 n+n^2)/(1-2 n)]))))/(b^2 (-1+n)^2 (1/4 c1 (3-n-Sqrt[1-2 n] Sqrt[(1+10 n+n^2)/(1-2 n)]) ((24 E^((2 Ne1)/n) (-1+(E^(-(Ne1/n)) (-1+n))/n)^2 n^4)/(b^2 (-1+n)^2)+6 ((2 E^(Ne1/n) (-1+(E^(-(Ne1/n)) (-1+n))/n) n^2)/(b^2 (-1+n))-(2 E^((2 Ne1)/n) (-1+(E^(-(Ne1/n)) (-1+n))/n)^2 n^3)/(b^2 (-1+n)^2)))^(-2+1/4 (3-n-Sqrt[1-2 n] Sqrt[(1+10 n+n^2)/(1-2 n)])) (-1+1/4 (3-n-Sqrt[1-2 n] Sqrt[(1+10 n+n^2)/(1-2 n)]))+1/4 c2 (3-n+Sqrt[1-2 n] Sqrt[(1+10 n+n^2)/(1-2 n)]) ((24 E^((2 Ne1)/n) (-1+(E^(-(Ne1/n)) (-1+n))/n)^2 n^4)/(b^2 (-1+n)^2)+6 ((2 E^(Ne1/n) (-1+(E^(-(Ne1/n)) (-1+n))/n) n^2)/(b^2 (-1+n))-(2 E^((2 Ne1)/n) (-1+(E^(-(Ne1/n)) (-1+n))/n)^2 n^3)/(b^2 (-1+n)^2)))^(-2+1/4 (3-n+Sqrt[1-2 n] Sqrt[(1+10 n+n^2)/(1-2 n)])) (-1+1/4 (3-n+Sqrt[1-2 n] Sqrt[(1+10 n+n^2)/(1-2 n)]))))))))/(1+(b^2 E^(-((2 Ne1)/n)) (-1+n)^2 ((2 E^(Ne1/n) (-1+(E^(-(Ne1/n)) (-1+n))/n) n^2)/(b^2 (-1+n))-(2 E^((2 Ne1)/n) (-1+(E^(-(Ne1/n)) (-1+n))/n)^2 n^3)/(b^2 (-1+n)^2)))/(2 (-1+(E^(-(Ne1/n)) (-1+n))/n)^2 n^4))"
str_r = "(12 b^4 E^(-((4 Ne1)/n)) (-1+n)^4 ((2 E^(Ne1/n) (-1+(E^(-(Ne1/n)) (-1+n))/n) n^2)/(b^2 (-1+n))-(2 E^((2 Ne1)/n) (-1+(E^(-(Ne1/n)) (-1+n))/n)^2 n^3)/(b^2 (-1+n)^2))^2)/((-1+(E^(-(Ne1/n)) (-1+n))/n)^4 n^8 (-1-(1/(2 (-1+(E^(-(Ne1/n)) (-1+n))/n)^2 n^4))b^2 E^(-((2 Ne1)/n)) (-1+n)^2 ((2 E^(Ne1/n) (-1+(E^(-(Ne1/n)) (-1+n))/n) n^2)/(b^2 (-1+n))-(2 E^((2 Ne1)/n) (-1+(E^(-(Ne1/n)) (-1+n))/n)^2 n^3)/(b^2 (-1+n)^2)) (-1-(24 E^((2 Ne1)/n) (-1+(E^(-(Ne1/n)) (-1+n))/n)^2 n^4 (1/4 c1 (3-n-Sqrt[1-2 n] Sqrt[(1+10 n+n^2)/(1-2 n)]) ((24 E^((2 Ne1)/n) (-1+(E^(-(Ne1/n)) (-1+n))/n)^2 n^4)/(b^2 (-1+n)^2)+6 ((2 E^(Ne1/n) (-1+(E^(-(Ne1/n)) (-1+n))/n) n^2)/(b^2 (-1+n))-(2 E^((2 Ne1)/n) (-1+(E^(-(Ne1/n)) (-1+n))/n)^2 n^3)/(b^2 (-1+n)^2)))^(-3+1/4 (3-n-Sqrt[1-2 n] Sqrt[(1+10 n+n^2)/(1-2 n)])) (-2+1/4 (3-n-Sqrt[1-2 n] Sqrt[(1+10 n+n^2)/(1-2 n)])) (-1+1/4 (3-n-Sqrt[1-2 n] Sqrt[(1+10 n+n^2)/(1-2 n)]))+1/4 c2 (3-n+Sqrt[1-2 n] Sqrt[(1+10 n+n^2)/(1-2 n)]) ((24 E^((2 Ne1)/n) (-1+(E^(-(Ne1/n)) (-1+n))/n)^2 n^4)/(b^2 (-1+n)^2)+6 ((2 E^(Ne1/n) (-1+(E^(-(Ne1/n)) (-1+n))/n) n^2)/(b^2 (-1+n))-(2 E^((2 Ne1)/n) (-1+(E^(-(Ne1/n)) (-1+n))/n)^2 n^3)/(b^2 (-1+n)^2)))^(-3+1/4 (3-n+Sqrt[1-2 n] Sqrt[(1+10 n+n^2)/(1-2 n)])) (-2+1/4 (3-n+Sqrt[1-2 n] Sqrt[(1+10 n+n^2)/(1-2 n)])) (-1+1/4 (3-n+Sqrt[1-2 n] Sqrt[(1+10 n+n^2)/(1-2 n)]))))/(b^2 (-1+n)^2 (1/4 c1 (3-n-Sqrt[1-2 n] Sqrt[(1+10 n+n^2)/(1-2 n)]) ((24 E^((2 Ne1)/n) (-1+(E^(-(Ne1/n)) (-1+n))/n)^2 n^4)/(b^2 (-1+n)^2)+6 ((2 E^(Ne1/n) (-1+(E^(-(Ne1/n)) (-1+n))/n) n^2)/(b^2 (-1+n))-(2 E^((2 Ne1)/n) (-1+(E^(-(Ne1/n)) (-1+n))/n)^2 n^3)/(b^2 (-1+n)^2)))^(-2+1/4 (3-n-Sqrt[1-2 n] Sqrt[(1+10 n+n^2)/(1-2 n)])) (-1+1/4 (3-n-Sqrt[1-2 n] Sqrt[(1+10 n+n^2)/(1-2 n)]))+1/4 c2 (3-n+Sqrt[1-2 n] Sqrt[(1+10 n+n^2)/(1-2 n)]) ((24 E^((2 Ne1)/n) (-1+(E^(-(Ne1/n)) (-1+n))/n)^2 n^4)/(b^2 (-1+n)^2)+6 ((2 E^(Ne1/n) (-1+(E^(-(Ne1/n)) (-1+n))/n) n^2)/(b^2 (-1+n))-(2 E^((2 Ne1)/n) (-1+(E^(-(Ne1/n)) (-1+n))/n)^2 n^3)/(b^2 (-1+n)^2)))^(-2+1/4 (3-n+Sqrt[1-2 n] Sqrt[(1+10 n+n^2)/(1-2 n)])) (-1+1/4 (3-n+Sqrt[1-2 n] Sqrt[(1+10 n+n^2)/(1-2 n)]))))))^2 (1-(b^2 E^(-((2 Ne1)/n)) (-1+n)^2 ((2 E^(Ne1/n) (-1+(E^(-(Ne1/n)) (-1+n))/n) n^2)/(b^2 (-1+n))-(2 E^((2 Ne1)/n) (-1+(E^(-(Ne1/n)) (-1+n))/n)^2 n^3)/(b^2 (-1+n)^2)))/(2 (-1+(E^(-(Ne1/n)) (-1+n))/n)^2 n^4 (-1-(1/(2 (-1+(E^(-(Ne1/n)) (-1+n))/n)^2 n^4))b^2 E^(-((2 Ne1)/n)) (-1+n)^2 ((2 E^(Ne1/n) (-1+(E^(-(Ne1/n)) (-1+n))/n) n^2)/(b^2 (-1+n))-(2 E^((2 Ne1)/n) (-1+(E^(-(Ne1/n)) (-1+n))/n)^2 n^3)/(b^2 (-1+n)^2)) (-1-(24 E^((2 Ne1)/n) (-1+(E^(-(Ne1/n)) (-1+n))/n)^2 n^4 (1/4 c1 (3-n-Sqrt[1-2 n] Sqrt[(1+10 n+n^2)/(1-2 n)]) ((24 E^((2 Ne1)/n) (-1+(E^(-(Ne1/n)) (-1+n))/n)^2 n^4)/(b^2 (-1+n)^2)+6 ((2 E^(Ne1/n) (-1+(E^(-(Ne1/n)) (-1+n))/n) n^2)/(b^2 (-1+n))-(2 E^((2 Ne1)/n) (-1+(E^(-(Ne1/n)) (-1+n))/n)^2 n^3)/(b^2 (-1+n)^2)))^(-3+1/4 (3-n-Sqrt[1-2 n] Sqrt[(1+10 n+n^2)/(1-2 n)])) (-2+1/4 (3-n-Sqrt[1-2 n] Sqrt[(1+10 n+n^2)/(1-2 n)])) (-1+1/4 (3-n-Sqrt[1-2 n] Sqrt[(1+10 n+n^2)/(1-2 n)]))+1/4 c2 (3-n+Sqrt[1-2 n] Sqrt[(1+10 n+n^2)/(1-2 n)]) ((24 E^((2 Ne1)/n) (-1+(E^(-(Ne1/n)) (-1+n))/n)^2 n^4)/(b^2 (-1+n)^2)+6 ((2 E^(Ne1/n) (-1+(E^(-(Ne1/n)) (-1+n))/n) n^2)/(b^2 (-1+n))-(2 E^((2 Ne1)/n) (-1+(E^(-(Ne1/n)) (-1+n))/n)^2 n^3)/(b^2 (-1+n)^2)))^(-3+1/4 (3-n+Sqrt[1-2 n] Sqrt[(1+10 n+n^2)/(1-2 n)])) (-2+1/4 (3-n+Sqrt[1-2 n] Sqrt[(1+10 n+n^2)/(1-2 n)])) (-1+1/4 (3-n+Sqrt[1-2 n] Sqrt[(1+10 n+n^2)/(1-2 n)]))))/(b^2 (-1+n)^2 (1/4 c1 (3-n-Sqrt[1-2 n] Sqrt[(1+10 n+n^2)/(1-2 n)]) ((24 E^((2 Ne1)/n) (-1+(E^(-(Ne1/n)) (-1+n))/n)^2 n^4)/(b^2 (-1+n)^2)+6 ((2 E^(Ne1/n) (-1+(E^(-(Ne1/n)) (-1+n))/n) n^2)/(b^2 (-1+n))-(2 E^((2 Ne1)/n) (-1+(E^(-(Ne1/n)) (-1+n))/n)^2 n^3)/(b^2 (-1+n)^2)))^(-2+1/4 (3-n-Sqrt[1-2 n] Sqrt[(1+10 n+n^2)/(1-2 n)])) (-1+1/4 (3-n-Sqrt[1-2 n] Sqrt[(1+10 n+n^2)/(1-2 n)]))+1/4 c2 (3-n+Sqrt[1-2 n] Sqrt[(1+10 n+n^2)/(1-2 n)]) ((24 E^((2 Ne1)/n) (-1+(E^(-(Ne1/n)) (-1+n))/n)^2 n^4)/(b^2 (-1+n)^2)+6 ((2 E^(Ne1/n) (-1+(E^(-(Ne1/n)) (-1+n))/n) n^2)/(b^2 (-1+n))-(2 E^((2 Ne1)/n) (-1+(E^(-(Ne1/n)) (-1+n))/n)^2 n^3)/(b^2 (-1+n)^2)))^(-2+1/4 (3-n+Sqrt[1-2 n] Sqrt[(1+10 n+n^2)/(1-2 n)])) (-1+1/4 (3-n+Sqrt[1-2 n] Sqrt[(1+10 n+n^2)/(1-2 n)]))))))))^2)"
#Keep in mind that parse_mathematica is not able to translate greek letters so before you grab the expressions make the appropriate substitutions
#Also refrain from calling the number of efolds N as it gets mistranslated to the Mathematica function N[]. I personally use Ne1
#In addition to that, using variables with subscripts is not recommended as it is untested terrritory
#Life hack : To make the whole process easier copy them from the notebook as plain text

input_symbols = sym.symbols('Ne1 b n c1 c2')
#The symbols of your expression. The Number of efolds must be first, eitherwise you would have to change the score function.

